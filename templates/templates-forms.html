<!-- templates/novo_projeto.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Novo Projeto de Pesquisa</h1>
    <a href="{{ url_for('lista_projetos') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Informações do Projeto</h5>
    </div>
    <div class="card-body">
        <form method="post">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="nome" class="form-label">Nome do Projeto</label>
                    <input type="text" class="form-control" id="nome" name="nome" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="area_conhecimento" class="form-label">Área de Conhecimento</label>
                    <input type="text" class="form-control" id="area_conhecimento" name="area_conhecimento" required>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="data_inicio" class="form-label">Data de Início</label>
                    <input type="date" class="form-control" id="data_inicio" name="data_inicio" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="data_fim" class="form-label">Data de Término (opcional)</label>
                    <input type="date" class="form-control" id="data_fim" name="data_fim">
                </div>
            </div>
            
            <div class="mb-3">
                <label for="descricao" class="form-label">Descrição</label>
                <textarea class="form-control" id="descricao" name="descricao" rows="5" required></textarea>
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary">Criar Projeto</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

<!-- templates/editar_projeto.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Editar Projeto</h1>
    <a href="{{ url_for('visualizar_projeto', projeto_id=projeto.id) }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Informações do Projeto</h5>
    </div>
    <div class="card-body">
        <form method="post">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="nome" class="form-label">Nome do Projeto</label>
                    <input type="text" class="form-control" id="nome" name="nome" value="{{ projeto.nome }}" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="area_conhecimento" class="form-label">Área de Conhecimento</label>
                    <input type="text" class="form-control" id="area_conhecimento" name="area_conhecimento" value="{{ projeto.area_conhecimento }}" required>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="data_inicio" class="form-label">Data de Início</label>
                    <input type="date" class="form-control" id="data_inicio" name="data_inicio" value="{{ projeto.data_inicio.strftime('%Y-%m-%d') }}" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="data_fim" class="form-label">Data de Término (opcional)</label>
                    <input type="date" class="form-control" id="data_fim" name="data_fim" value="{{ projeto.data_fim.strftime('%Y-%m-%d') if projeto.data_fim else '' }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="status" class="form-label">Status</label>
                    <select class="form-select" id="status" name="status" required>
                        <option value="Em andamento" {% if projeto.status == 'Em andamento' %}selected{% endif %}>Em andamento</option>
                        <option value="Concluído" {% if projeto.status == 'Concluído' %}selected{% endif %}>Concluído</option>
                        <option value="Suspenso" {% if projeto.status == 'Suspenso' %}selected{% endif %}>Suspenso</option>
                        <option value="Cancelado" {% if projeto.status == 'Cancelado' %}selected{% endif %}>Cancelado</option>
                    </select>
                </div>
            </div>
            
            <div class="mb-3">
                <label for="descricao" class="form-label">Descrição</label>
                <textarea class="form-control" id="descricao" name="descricao" rows="5" required>{{ projeto.descricao }}</textarea>
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary">Salvar Alterações</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

<!-- templates/adicionar_pesquisador.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Adicionar Pesquisador ao Projeto</h1>
    <a href="{{ url_for('visualizar_projeto', projeto_id=projeto.id) }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Projeto: {{ projeto.nome }}</h5>
    </div>
    <div class="card-body">
        <form method="post">
            <div class="mb-3">
                <label for="email_pesquisador" class="form-label">E-mail do Pesquisador</label>
                <input type="email" class="form-control" id="email_pesquisador" name="email_pesquisador" required>
                <div class="form-text">Digite o e-mail do pesquisador cadastrado no sistema.</div>
            </div>
            
            <div class="mb-3">
                <label for="funcao" class="form-label">Função no Projeto</label>
                <select class="form-select" id="funcao" name="funcao" required>
                    <option value="Pesquisador">Pesquisador</option>
                    <option value="Colaborador">Colaborador</option>
                    <option value="Bolsista">Bolsista</option>
                    <option value="Orientando">Orientando</option>
                    <option value="Coorientador">Coorientador</option>
                </select>
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary">Adicionar Pesquisador</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

<!-- templates/adicionar_evento.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Adicionar Evento ao Projeto</h1>
    <a href="{{ url_for('visualizar_projeto', projeto_id=projeto.id) }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Projeto: {{ projeto.nome }}</h5>
    </div>
    <div class="card-body">
        <form method="post">
            <div class="mb-3">
                <label for="evento_existente" class="form-label">Evento Existente</label>
                <select class="form-select" id="evento_existente" name="evento_existente">
                    <option value="0">-- Novo Evento --</option>
                    {% for evento in eventos %}
                    <option value="{{ evento.id }}">{{ evento.nome }} ({{ evento.data_inicio.strftime('%d/%m/%Y') }})</option>
                    {% endfor %}
                </select>
            </div>
            
            <div id="novo_evento">
                <h6 class="mt-4 mb-3">Novo Evento</h6>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="nome" class="form-label">Nome do Evento</label>
                        <input type="text" class="form-control" id="nome" name="nome">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="tipo" class="form-label">Tipo</label>
                        <select class="form-select" id="tipo" name="tipo">
                            <option value="Conferência">Conferência</option>
                            <option value="Congresso">Congresso</option>
                            <option value="Simpósio">Simpósio</option>
                            <option value="Workshop">Workshop</option>
                            <option value="Seminário">Seminário</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="data_inicio" class="form-label">Data de Início</label>
                        <input type="date" class="form-control" id="data_inicio" name="data_inicio">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="data_fim" class="form-label">Data de Término</label>
                        <input type="date" class="form-control" id="data_fim" name="data_fim">
                    </div>
                </div>
                
                <div class="mb-3">
                    <label for="local" class="form-label">Local</label>
                    <input type="text" class="form-control" id="local" name="local">
                </div>
            </div>
            
            <div class="mb-3">
                <label for="data_participacao" class="form-label">Data da Participação</label>
                <input type="date" class="form-control" id="data_participacao" name="data_participacao">
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary">Adicionar Evento</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const eventoSelect = document.getElementById('evento_existente');
        const novoEventoDiv = document.getElementById('novo_evento');
        
        // Função para mostrar/ocultar o formulário de novo evento
        function toggleNovoEvento() {
            if (eventoSelect.value === '0') {
                novoEventoDiv.style.display = 'block';
                // Tornar os campos obrigatórios
                document.getElementById('nome').required = true;
                document.getElementById('data_inicio').required = true;
            } else {
                novoEventoDiv.style.display = 'none';
                // Remover a obrigatoriedade dos campos
                document.getElementById('nome').required = false;
                document.getElementById('data_inicio').required = false;
            }
        }
        
        // Verificar o estado inicial
        toggleNovoEvento();
        
        // Adicionar o evento change
        eventoSelect.addEventListener('change', toggleNovoEvento);
    });
</script>
{% endblock %}

<!-- templates/adicionar_referencia.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Adicionar Referência ao Projeto</h1>
    <a href="{{ url_for('visualizar_projeto', projeto_id=projeto.id) }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Projeto: {{ projeto.nome }}</h5>
    </div>
    <div class="card-body">
        <form method="post">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="tipo" class="form-label">Tipo de Referência</label>
                    <select class="form-select" id="tipo" name="tipo" required>
                        <option value="Artigo">Artigo</option>
                        <option value="Livro">Livro</option>
                        <option value="Capítulo de Livro">Capítulo de Livro</option>
                        <option value="Tese">Tese</option>
                        <option value="Dissertação">Dissertação</option>
                        <option value="Anais">Artigo em Anais</option>
                        <option value="Outro">Outro</option>
                    </select>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="ano" class="form-label">Ano</label>
                    <input type="number" class="form-control" id="ano" name="ano" min="1900" max="2100" required>
                </div>
            </div>
            
            <div class="mb-3">
                <label for="titulo" class="form-label">Título</label>
                <input type="text" class="form-control" id="titulo" name="titulo" required>
            </div>
            
            <div class="mb-3">
                <label for="autores" class="form-label">Autores</label>
                <input type="text" class="form-control" id="autores" name="autores" required>
                <div class="form-text">Separe os nomes dos autores com ponto-e-vírgula (;)</div>
            </div>
            
            <div class="mb-3">
                <label for="publicacao" class="form-label">Publicação/Periódico</label>
                <input type="text" class="form-control" id="publicacao" name="publicacao">
            </div>
            
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="volume" class="form-label">Volume</label>
                    <input type="text" class="form-control" id="volume" name="volume">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="numero" class="form-label">Número</label>
                    <input type="text" class="form-control" id="numero" name="numero">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="paginas" class="form-label">Páginas</label>
                    <input type="text" class="form-control" id="paginas" name="paginas">
                </div>
            </div>
            
            <div class="mb-3">
                <label for="doi" class="form-label">DOI</label>
                <input type="text" class="form-control" id="doi" name="doi">
            </div>
            
            <div class="mb-3">
                <label for="url" class="form-label">URL</label>
                <input type="url" class="form-control" id="url" name="url">
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary">Adicionar Referência</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

<!-- templates/nova_instituicao.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Nova Instituição</h1>
    <a href="{{ url_for('lista_instituicoes') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Informações da Instituição</h5>
    </div>
    <div class="card-body">
        <form method="post">
            <div class="row">
                <div class="col-md-8 mb-3">
                    <label for="nome" class="form-label">Nome da Instituição</label>
                    <input type="text" class="form-control" id="nome" name="nome" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="sigla" class="form-label">Sigla</label>
                    <input type="text" class="form-control" id="sigla" name="sigla" required>
                </div>
            </div>
            
            <div class="mb-3">
                <label for="tipo" class="form-label">Tipo</label>
                <select class="form-select" id="tipo" name="tipo" required>
                    <option value="Universidade Pública">Universidade Pública</option>
                    <option value="Universidade Privada">Universidade Privada</option>
                    <option value="Instituto de Pesquisa">Instituto de Pesquisa</option>
                    <option value="Centro Tecnológico">Centro Tecnológico</option>
                    <option value="Empresa">Empresa</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
            
            <div class="mb-3">
                <label for="endereco" class="form-label">Endereço</label>
                <input type="text" class="form-control" id="endereco" name="endereco">
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="cidade" class="form-label">Cidade</label>
                    <input type="text" class="form-control" id="cidade" name="cidade" required>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="estado" class="form-label">Estado</label>
                    <select class="form-select" id="estado" name="estado" required>
                        <option value="AC">AC</option>
                        <option value="AL">AL</option>
                        <option value="AP">AP</option>
                        <option value="AM">AM</option>
                        <option value="BA">BA</option>
                        <option value="CE">CE</option>
                        <option value="DF">DF</option>
                        <option value="ES">ES</option>
                        <option value="GO">GO</option>
                        <option value="MA">MA</option>
                        <option value="MT">MT</option>
                        <option value="MS">MS</option>
                        <option value="MG">MG</option>
                        <option value="PA">PA</option>
                        <option value="PB">PB</option>
                        <option value="PR">PR</option>
                        <option value="PE">PE</option>
                        <option value="PI">PI</option>
                        <option value="RJ">RJ</option>
                        <option value="RN">RN</option>
                        <option value="RS">RS</option>
                        <option value="RO">RO</option>
                        <option value="RR">RR</option>
                        <option value="SC">SC</option>
                        <option value="SP">SP</option>
                        <option value="SE">SE</option>
                        <option value="TO">TO</option>
                    </select>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="cep" class="form-label">CEP</label>
                    <input type="text" class="form-control" id="cep" name="cep">
                </div>
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary">Cadastrar Instituição</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

<!-- templates/editar_perfil.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Editar Perfil</h1>
    <a href="{{ url_for('perfil') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Informações do Pesquisador</h5>
    </div>
    <div class="card-body">
        <form method="post">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="nome" class="form-label">Nome Completo</label>
                    <input type="text" class="form-control" id="nome" name="nome" value="{{ pesquisador.nome }}" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="instituicao_id" class="form-label">Instituição</label>
                    <select class="form-select" id="instituicao_id" name="instituicao_id">
                        <option value="">Selecione...</option>
                        {% for instituicao in instituicoes %}
                        <option value="{{ instituicao.id }}" {% if pesquisador.instituicao_id == instituicao.id %}selected{% endif %}>
                            {{ instituicao.sigla }} - {{ instituicao.nome }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="lattes_id" class="form-label">ID Lattes</label>
                    <input type="text" class="form-control" id="lattes_id" name="lattes_id" value="{{ pesquisador.lattes_id or '' }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="orcid" class="form-label">ORCID</label>
                    <input type="text" class="form-control" id="orcid" name="orcid" value="{{ pesquisador.orcid or '' }}" placeholder="0000-0000-0000-0000">
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="departamento" class="form-label">Departamento</label>
                    <input type="text" class="form-control" id="departamento" name="departamento" value="{{ pesquisador.departamento or '' }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="titulacao" class="form-label">Titulação</label>
                    <select class="form-select" id="titulacao" name="titulacao">
                        <option value="">Selecione...</option>
                        <option value="Graduado" {% if pesquisador.titulacao == 'Graduado' %}selected{% endif %}>Graduado</option>
                        <option value="Especialista" {% if pesquisador.titulacao == 'Especialista' %}selected{% endif %}>Especialista</option>
                        <option value="Mestre" {% if pesquisador.titulacao == 'Mestre' %}selected{% endif %}>Mestre</option>
                        <option value="Doutor" {% if pesquisador.titulacao == 'Doutor' %}selected{% endif %}>Doutor</option>
                        <option value="Pós-Doutor" {% if pesquisador.titulacao == 'Pós-Doutor' %}selected{% endif %}>Pós-Doutor</option>
                    </select>
                </div>
            </div>
            
            <div class="mb-3">
                <label for="area_atuacao" class="form-label">Área de Atuação</label>
                <input type="text" class="form-control" id="area_atuacao" name="area_atuacao" value="{{ pesquisador.area_atuacao or '' }}">
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary">Salvar Perfil</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

<!-- templates/importar_dados.html -->
{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">Importar/Exportar Dados</h1>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Importar Dados</h5>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="arquivo" class="form-label">Selecione um arquivo CSV</label>
                        <input class="form-control" type="file" id="arquivo" name="arquivo" accept=".csv" required>
                        <div class="form-text">
                            O arquivo CSV deve conter as colunas: nome, descricao, area_conhecimento, data_inicio, data_fim (opcional), status (opcional)
                        </div>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-upload"></i> Importar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Exportar Dados</h5>
            </div>
            <div class="card-body">
                <h6 class="mb-3">Projetos</h6>
                <div class="d-grid gap-2">
                    <a href="{{ url_for('exportar_dados', tipo='projetos', formato='csv') }}" class="btn btn-outline-primary">
                        <i class="bi bi-file-earmark-excel"></i> Exportar para CSV
                    </a>
                    <a href="{{ url_for('exportar_dados', tipo='projetos', formato='json') }}" class="btn btn-outline-primary">
                        <i class="bi bi-file-earmark-code"></i> Exportar para JSON
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">Modelo de CSV para Importação</h5>
    </div>
    <div class="card-body">
        <pre><code>nome,descricao,area_conhecimento,data_inicio,data_fim,status
"Análise de Dados em Grande Escala","Descrição do projeto...","Ciência de Dados",2023-01-01,2024-12-31,Em andamento
"Desenvolvimento de Algoritmos Eficientes","Outra descrição...","Algoritmos",2023-02-15,,Em andamento</code></pre>
    </div>
</div>
{% endblock %}

<!-- templates/pesquisadores.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Pesquisadores</h1>
</div>

<div class="card mb-4">
    <div class="card-header bg-light">
        <h5 class="card-title mb-0">Buscar Pesquisadores</h5>
    </div>
    <div class="card-body">
        <form action="{{ url_for('lista_pesquisadores') }}" method="get" class="row g-3">
            <div class="col-md-6">
                <label for="q" class="form-label">Nome</label>
                <input type="text" class="form-control" id="q" name="q" value="{{ termo_busca }}">
            </div>
            <div class="col-md-4">
                <label for="instituicao_id" class="form-label">Instituição</label>
                <select class="form-select" id="instituicao_id" name="instituicao_id">
                    <option value="">Todas</option>
                    {% for instituicao in instituicoes %}
                    <option value="{{ instituicao.id }}" {% if request.args.get('instituicao_id') == instituicao.id|string %}selected{% endif %}>
                        {{ instituicao.sigla }} - {{ instituicao.nome }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-2 d-flex align-items-end">
                <button type="submit" class="btn btn-primary w-100">Buscar</button>
            </div>
        </form>
    </div>
</div>

{% if pesquisadores %}
<div class="row">
    {% for pesquisador in pesquisadores %}
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">{{ pesquisador.nome }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">
                    {{ pesquisador.titulacao }}
                    {% if pesquisador.instituicao %}
                    - {{ pesquisador.instituicao.sigla }}
                    {% endif %}
                </h6>
                
                {% if pesquisador.area_atuacao %}
                <p class="card-text">
                    <strong>Área de Atuação:</strong> {{ pesquisador.area_atuacao }}
                </p>
                {% endif %}
                
                {% if pesquisador.lattes_id %}
                <p class="mb-1">
                    <a href="http://lattes.cnpq.br/{{ pesquisador.lattes_id }}" target="_blank" class="card-link">
                        <i class="bi bi-file-earmark-text"></i> Currículo Lattes
                    </a>
                </p>
                {% endif %}
                
                {% if pesquisador.orcid %}
                <p class="mb-1">
                    <a href="https://orcid.org/{{ pesquisador.orcid }}" target="_blank" class="card-link">
                        <i class="bi bi-person-badge"></i> ORCID
                    </a>
                </p>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">
    <i class="bi bi-info-circle"></i> Nenhum pesquisador encontrado com os filtros selecionados.
</div>
{% endif %}
{% endblock %}

<!-- templates/perfil.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Meu Perfil</h1>
    <a href="{{ url_for('editar_perfil') }}" class="btn btn-primary">
        <i class="bi bi-pencil"></i> Editar Perfil
    </a>
</div>

<div class="row">
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="card-title mb-0">Informações Básicas</h5>
            </div>
            <div class="card-body">
                <h3 class="mb-3">{{ usuario.pesquisador.nome }}</h3>
                <p><strong>E-mail:</strong> {{ usuario.email }}</p>
                <p><strong>Membro desde:</strong> {{ usuario.data_cadastro.strftime('%d/%m/%Y') }}</p>
                
                {% if usuario.pesquisador.titulacao %}
                <p><strong>Titulação:</strong> {{ usuario.pesquisador.titulacao }}</p>
                {% endif %}
                
                {% if usuario.pesquisador.area_atuacao %}
                <p><strong>Área de Atuação:</strong> {{ usuario.pesquisador.area_atuacao }}</p>
                {% endif %}
                
                {% if usuario.pesquisador.instituicao %}
                <p><strong>Instituição:</strong> {{ usuario.pesquisador.instituicao.nome }}</p>
                
                {% if usuario.pesquisador.departamento %}
                <p><strong>Departamento:</strong> {{ usuario.pesquisador.departamento }}</p>
                {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="col-md-8">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Identificadores Acadêmicos</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    {% if usuario.pesquisador.lattes_id %}
                    <div class="col-md-6 mb-3">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5>Currículo Lattes</h5>
                                <p>ID: {{ usuario.pesquisador.lattes_id }}</p>
                                <a href="http://lattes.cnpq.br/{{ usuario.pesquisador.lattes_id }}" target="_blank" class="btn btn-outline-primary">
                                    <i class="bi bi-box-arrow-up-right"></i> Acessar
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if usuario.pesquisador.orcid %}
                    <div class="col-md-6 mb-3">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5>ORCID</h5>
                                <p>ID: {{ usuario.pesquisador.orcid }}</p>
                                <a href="https://orcid.org/{{ usuario.pesquisador.orcid }}" target="_blank" class="btn btn-outline-primary">
                                    <i class="bi bi-box-arrow-up-right"></i> Acessar
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if not usuario.pesquisador.lattes_id and not usuario.pesquisador.orcid %}
                    <div class="col-12">
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle"></i> Você ainda não adicionou identificadores acadêmicos ao seu perfil.
                            <a href="{{ url_for('editar_perfil') }}" class="alert-link">Adicione agora!</a>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Estatísticas</h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-4 mb-3">
                        <div class="p-3 border rounded">
                            <h3>{{ usuario.pesquisador.projetos|length }}</h3>
                            <p class="text-muted mb-0">Projetos</p>
                        </div>
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <div class="p-3 border rounded">
                            <h3>{{ usuario.pesquisador.projetos.filter(Projeto.status == 'Em andamento').count() }}</h3>
                            <p class="text-muted mb-0">Em andamento</p>
                        </div>
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <div class="p-3 border rounded">
                            <h3>{{ usuario.pesquisador.projetos.filter(Projeto.status == 'Concluído').count() }}</h3>
                            <p class="text-muted mb-0">Concluídos</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

<!-- templates/instituicoes.html -->
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Instituições</h1>
    <a href="{{ url_for('nova_instituicao') }}" class="btn btn-primary">
        <i class="bi bi-plus-circle"></i> Nova Instituição
    </a>
</div>

{% if instituicoes %}
<div class="row">
    {% for instituicao in instituicoes %}
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="card-title mb-0">{{ instituicao.sigla }} - {{ instituicao.nome }}</h5>
            </div>
            <div class="card-body">
                <p><strong>Tipo:</strong> {{ instituicao.tipo }}</p>
                
                {% if instituicao.cep %}
                <p><strong>CEP:</strong> {{ instituicao.cep }}</p>
                {% endif %}
            </div>
            <div class="card-footer bg-transparent">
                <div class="text-end">
                    <span class="text-muted">{{ instituicao.pesquisadores|length }} pesquisadores vinculados</span>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">
    <i class="bi bi-info-circle"></i> Nenhuma instituição cadastrada.
</div>
{% endif %}
{% endblock %}

<!-- templates/relatorios.html -->
{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">Relatórios</h1>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Projetos por Ano</h5>
            </div>
            <div class="card-body">
                <canvas id="chartAnos" height="250"></canvas>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Distribuição por Status</h5>
            </div>
            <div class="card-body">
                <canvas id="chartStatus" height="250"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Áreas de Conhecimento</h5>
            </div>
            <div class="card-body">
                <canvas id="chartAreas" height="250"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Exportar Relatórios</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card mb-3">
                            <div class="card-body text-center py-4">
                                <i class="bi bi-file-earmark-excel display-4 text-success"></i>
                                <h5 class="mt-3">Relatório de Projetos</h5>
                                <p class="text-muted">Exporta todos os seus projetos e detalhes</p>
                                <a href="{{ url_for('exportar_dados', tipo='projetos', formato='csv') }}" class="btn btn-outline-success">
                                    <i class="bi bi-download"></i> Baixar CSV
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="card mb-3">
                            <div class="card-body text-center py-4">
                                <i class="bi bi-file-earmark-text display-4 text-primary"></i>
                                <h5 class="mt-3">Relatório de Eventos</h5>
                                <p class="text-muted">Exporta eventos e participações</p>
                                <button class="btn btn-outline-primary" disabled>
                                    <i class="bi bi-download"></i> Em breve
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="card mb-3">
                            <div class="card-body text-center py-4">
                                <i class="bi bi-file-earmark-code display-4 text-danger"></i>
                                <h5 class="mt-3">Relatório de Produção</h5>
                                <p class="text-muted">Exporta dados de produção acadêmica</p>
                                <button class="btn btn-outline-danger" disabled>
                                    <i class="bi bi-download"></i> Em breve
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Buscar dados para os gráficos
        fetch('/api/projetos/estatisticas')
            .then(response => response.json())
            .then(data => {
                // Gráfico de Anos
                const anosLabels = Object.keys(data.anos || {}).sort();
                const anosData = anosLabels.map(ano => data.anos[ano] || 0);
                
                new Chart(document.getElementById('chartAnos'), {
                    type: 'line',
                    data: {
                        labels: anosLabels,
                        datasets: [{
                            label: 'Projetos Iniciados',
                            data: anosData,
                            borderColor: '#0d6efd',
                            backgroundColor: 'rgba(13, 110, 253, 0.1)',
                            tension: 0.2,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
                
                // Gráfico de Status
                const statusLabels = Object.keys(data.status || {});
                const statusData = Object.values(data.status || {});
                
                new Chart(document.getElementById('chartStatus'), {
                    type: 'doughnut',
                    data: {
                        labels: statusLabels,
                        datasets: [{
                            data: statusData,
                            backgroundColor: ['#0d6efd', '#198754', '#ffc107', '#dc3545', '#6c757d']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                
                // Gráfico de Áreas
                const areaLabels = Object.keys(data.areas || {});
                const areaData = Object.values(data.areas || {});
                
                new Chart(document.getElementById('chartAreas'), {
                    type: 'bar',
                    data: {
                        labels: areaLabels,
                        datasets: [{
                            label: 'Projetos',
                            data: areaData,
                            backgroundColor: '#0d6efd'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
            });
    });
</script>
{% endblock %}idade and instituicao.estado %}
                <p><strong>Localização:</strong> {{ instituicao.cidade }}/{{ instituicao.estado }}</p>
                {% endif %}
                
                {% if instituicao.endereco %}
                <p><strong>Endereço:</strong> {{ instituicao.endereco }}</p>
                {% endif %}
                
                {% if instituicao.c